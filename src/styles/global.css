@import "tailwindcss";

@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

@theme inline {
  --font-sans: "Satoshi", system-ui, sans-serif;

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-warm: var(--color-warm);
  --color-warm-muted: var(--color-warm-muted);
}

:root {
  --background: #faf8f5;
  --foreground: #2c2c2c;

  --card: #f3f0eb;
  --card-foreground: #2c2c2c;

  --popover: #ede9e3;
  --popover-foreground: #2c2c2c;

  --primary: #2c2c2c;
  --primary-foreground: #faf8f5;

  --secondary: #f3f0eb;
  --secondary-foreground: #2c2c2c;

  --muted: #f3f0eb;
  --muted-foreground: #8a8580;

  --accent: #ede9e3;
  --accent-foreground: #2c2c2c;

  --destructive: #c4453a;
  --destructive-foreground: #faf8f5;

  --border: #e4dfd8;
  --input: #e4dfd8;
  --ring: #4a8f8c;

  --color-warm: #4a8f8c;
  --color-warm-muted: #4a8f8c18;

  --transition-fast: 150ms;
  --transition-normal: 200ms;
  --transition-slow: 300ms;
  --ease-default: ease-out;
}

[data-theme="dark"] {
  --background: #1a1a1d;
  --foreground: #e8e4df;

  --card: #222225;
  --card-foreground: #e8e4df;

  --popover: #2a2a2e;
  --popover-foreground: #e8e4df;

  --primary: #e8e4df;
  --primary-foreground: #1a1a1d;

  --secondary: #222225;
  --secondary-foreground: #e8e4df;

  --muted: #2a2a2e;
  --muted-foreground: #8a8580;

  --accent: #222225;
  --accent-foreground: #e8e4df;

  --destructive: #e05a4f;
  --destructive-foreground: #1a1a1d;

  --border: #363639;
  --input: #363639;
  --ring: #6db3b0;

  --color-warm: #6db3b0;
  --color-warm-muted: #6db3b018;
}

/* Smooth theme transitions */
:root,
[data-theme="dark"] {
  transition:
    background-color var(--transition-slow) ease-in-out,
    color var(--transition-slow) ease-in-out,
    border-color var(--transition-slow) ease-in-out;
}

/* ==========================================================================
   Base Styles
   ========================================================================== */

@layer base {
  *,
  ::after,
  ::before {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-sans;
  }

  /* Typography base styles */
  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply wrap-break-word;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply text-balance;
  }

  p {
    @apply text-pretty;
  }
}

/* ==========================================================================
   Component Classes
   Reusable patterns extracted from components
   ========================================================================== */

@layer components {
  .card-hover {
    @apply rounded-lg overflow-hidden border border-border/60;
    @apply hover:border-border hover:bg-accent transition-all;
    transition-duration: var(--transition-normal);
  }

  .card-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgb(0 0 0 / 0.06);
  }

  :where([data-theme="dark"]) .card-hover:hover {
    box-shadow: 0 4px 12px rgb(0 0 0 / 0.3);
  }

  .tag-pill {
    @apply inline-flex items-center text-xs px-2 py-0.5 rounded-full;
    @apply bg-muted text-muted-foreground;
  }

  .icon-button {
    @apply inline-flex items-center justify-center;
    @apply text-foreground/60 hover:text-foreground;
    @apply rounded-md transition-colors hover:bg-muted;
  }

  .nav-link {
    @apply relative text-muted-foreground hover:text-foreground transition-colors;
  }

  .nav-link::after {
    content: "";
    @apply absolute -bottom-0.5 left-0 h-px w-0 bg-foreground/40;
    transition: width 0.2s ease-out;
  }

  .nav-link:hover::after {
    @apply w-full;
  }

  .fade-in {
    animation: fadeIn 0.35s var(--ease-default) forwards;
    opacity: 0;
  }

  .page-enter {
    animation: pageEnter 0.4s var(--ease-default) both;
  }

  .page-enter-delay-1 {
    animation-delay: 0.06s;
  }

  .page-enter-delay-2 {
    animation-delay: 0.12s;
  }

  .page-enter-delay-3 {
    animation-delay: 0.18s;
  }

  .fade-in-delay-1 {
    animation-delay: 0.06s;
  }

  .fade-in-delay-2 {
    animation-delay: 0.12s;
  }

  .fade-in-delay-3 {
    animation-delay: 0.18s;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(6px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pageEnter {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ==========================================================================
     Prose Styles (Typography for blog content)
     ========================================================================== */

  .prose {
    @apply text-foreground text-base leading-relaxed;

    :where(p):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 my-5;
    }

    :where(h1, h2, h3, h4, h5, h6):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground scroll-mt-24 font-semibold;
    }

    :first-child:not(:where(.not-prose, .not-prose *)) {
      @apply mt-0;
    }

    :where(h1):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-6 text-4xl;
    }

    :where(h2):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-4 text-2xl;
    }

    :where(h3):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-4 text-xl;
    }

    :where(h4):not(:where(.not-prose, .not-prose *)) {
      @apply mt-7 mb-3 text-lg;
    }

    :where(h5, h6):not(:where(.not-prose, .not-prose *)) {
      @apply mt-5 mb-3;
    }

    :where(a):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground decoration-muted-foreground hover:decoration-foreground font-medium wrap-break-word underline underline-offset-[3px] transition-colors;
    }

    :where(strong):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground font-medium;
    }

    :where(ul):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-5 ml-6 list-disc [&>li]:mt-2;
    }

    :where(ol):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-5 ml-6 list-decimal [&>li]:mt-2;
      @apply [[type="A"]]:list-[upper-alpha] [[type="I"]]:list-[upper-roman] [[type="a"]]:list-[lower-alpha] [[type="i"]]:list-[lower-roman];
    }

    :where(li):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 pl-2 [&>p]:my-0;
    }

    :where(ul ul, ol ol, ul ol, ol ul):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-2 ml-6;
    }

    :where(code):not(:where(.not-prose, .not-prose *)) {
      @apply bg-muted/50 text-foreground relative rounded-sm px-[0.3rem] py-[0.2rem] text-sm font-medium wrap-break-word;
    }

    :where(blockquote):not(:where(.not-prose, .not-prose *)) {
      @apply **:text-muted-foreground my-6 border-l-2 pl-6;
    }

    :where(hr):not(:where(.not-prose, .not-prose *)) {
      @apply my-8 border-t;
    }

    :where(table):not(:where(.not-prose, .not-prose *)) {
      @apply mx-auto my-6 block max-w-fit overflow-x-auto text-sm;
    }

    :where(thead):not(:where(.not-prose, .not-prose *)) {
      @apply border-muted-foreground/30 border-b;
    }

    :where(th):not(:where(.not-prose, .not-prose *)) {
      @apply px-4 py-2 font-medium;
      @apply text-left [[align="center"]]:text-center [[align="right"]]:text-right;
    }

    :where(tr):not(:where(.not-prose, .not-prose *)) {
      @apply border-muted-foreground/30 border-y first:border-t-0 last:border-b-0;
    }

    :where(td):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 px-4 py-2 align-top wrap-break-word *:first:mt-0! *:last:mb-0!;
      @apply text-left [[align="center"]]:text-center [[align="right"]]:text-right;
    }

    :where(img, video, figure, .expressive-code):not(:where(.not-prose, .not-prose *)) {
      @apply mx-auto my-6;
    }

    :where(pre):not(:where(.not-prose, .not-prose *)) {
      @apply max-h-[min(68vh,1000px)]! overflow-y-auto;
    }

    :where(kbd):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground bg-muted rounded-md border px-2 py-1 text-xs font-medium;
    }
  }
}

@layer base {
  ::view-transition-old(page-main),
  ::view-transition-new(page-main) {
    animation-duration: 200ms;
    animation-timing-function: var(--ease-default);
  }

  ::view-transition-old(page-main) {
    animation-name: viewFadeOut;
  }

  ::view-transition-new(page-main) {
    animation-name: viewFadeIn;
  }

  /* Theme transition animations */
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 300ms;
    animation-timing-function: var(--ease-default);
  }

  ::view-transition-old(root) {
    animation-name: viewFadeOut;
  }

  ::view-transition-new(root) {
    animation-name: viewFadeIn;
  }
}

@keyframes viewFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes viewFadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* ==========================================================================
   Accessibility
   ========================================================================== */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  ::before,
  ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 0.01ms !important;
  }
}
