/**
 * Global Styles
 *
 * This file contains all global CSS for the portfolio site.
 * Theme colors are defined using the Rose Pine palette.
 *
 * Color System:
 * - Light mode uses Rose Pine Dawn variant
 * - Dark mode uses Rose Pine Main variant
 *
 * To change the color theme, modify the values in src/themes/
 * and update the CSS variables below accordingly.
 */

@import "tailwindcss";

@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* ==========================================================================
   Theme Configuration (Tailwind CSS v4)
   ========================================================================== */

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
}

/* ==========================================================================
   Rose Pine Theme - Dawn (Light Mode)
   https://rosepinetheme.com/palette
   ========================================================================== */

:root {
  /* Backgrounds */
  --background: #faf4ed; /* Base */
  --foreground: #575279; /* Text */

  --card: #fffaf3; /* Surface */
  --card-foreground: #575279; /* Text */

  --popover: #f2e9e1; /* Overlay */
  --popover-foreground: #575279; /* Text */

  /* Primary - Rose accent */
  --primary: #d7827e; /* Rose */
  --primary-foreground: #faf4ed; /* Base */

  /* Secondary */
  --secondary: #f2e9e1; /* Overlay */
  --secondary-foreground: #575279; /* Text */

  /* Muted elements */
  --muted: #f2e9e1; /* Overlay */
  --muted-foreground: #9893a5; /* Muted */

  /* Accent highlights */
  --accent: #f4ede8; /* Highlight Low */
  --accent-foreground: #575279; /* Text */

  /* Destructive (errors/warnings) */
  --destructive: #b4637a; /* Love */
  --destructive-foreground: #faf4ed; /* Base */

  /* Borders and inputs */
  --border: #dfdad9; /* Highlight Med */
  --input: #dfdad9; /* Highlight Med */
  --ring: #d7827e; /* Rose */

  /* Transition durations */
  --transition-fast: 150ms;
  --transition-normal: 200ms;
  --transition-slow: 300ms;
  --ease-default: ease-out;
}

/* ==========================================================================
   Rose Pine Theme - Main (Dark Mode)
   https://rosepinetheme.com/palette
   ========================================================================== */

[data-theme="dark"] {
  /* Backgrounds */
  --background: #191724; /* Base */
  --foreground: #e0def4; /* Text */

  --card: #1f1d2e; /* Surface */
  --card-foreground: #e0def4; /* Text */

  --popover: #26233a; /* Overlay */
  --popover-foreground: #e0def4; /* Text */

  /* Primary - Rose accent */
  --primary: #ebbcba; /* Rose */
  --primary-foreground: #191724; /* Base */

  /* Secondary */
  --secondary: #26233a; /* Overlay */
  --secondary-foreground: #e0def4; /* Text */

  /* Muted elements */
  --muted: #26233a; /* Overlay */
  --muted-foreground: #6e6a86; /* Muted */

  /* Accent highlights */
  --accent: #21202e; /* Highlight Low */
  --accent-foreground: #e0def4; /* Text */

  /* Destructive (errors/warnings) */
  --destructive: #eb6f92; /* Love */
  --destructive-foreground: #191724; /* Base */

  /* Borders and inputs */
  --border: #403d52; /* Highlight Med */
  --input: #403d52; /* Highlight Med */
  --ring: #ebbcba; /* Rose */
}

/* Smooth theme transitions */
:root,
[data-theme="dark"] {
  transition:
    background-color var(--transition-slow) ease-in-out,
    color var(--transition-slow) ease-in-out,
    border-color var(--transition-slow) ease-in-out;
}

/* ==========================================================================
   Base Styles
   ========================================================================== */

@layer base {
  *,
  ::after,
  ::before {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
  }

  /* Typography base styles */
  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply wrap-break-word;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply text-balance;
  }

  p {
    @apply text-pretty;
  }
}

/* ==========================================================================
   Component Classes
   Reusable patterns extracted from components
   ========================================================================== */

@layer components {
  /* Card hover effect - used by BlogCard, ProjectCard */
  .card-hover {
    @apply border border-border rounded-lg overflow-hidden;
    @apply hover:bg-muted/50 transition-colors ease-in-out;
    transition-duration: var(--transition-normal);
    transition-property: background-color, border-color, color, transform, box-shadow;
  }

  .card-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px -18px hsl(var(--foreground) / 0.35);
  }

  /* Tag pill styling - used for tags in cards and posts */
  .tag-pill {
    @apply text-xs px-2 py-1 bg-muted text-muted-foreground rounded-md;
  }

  /* Icon button - used for social links, theme picker, search */
  .icon-button {
    @apply inline-flex items-center justify-center;
    @apply text-foreground/60 hover:text-foreground hover:bg-muted;
    @apply rounded-md transition-colors;
  }

  /* Nav link styling */
  .nav-link {
    @apply text-foreground/60 hover:text-foreground transition-colors;
    position: relative;
  }

  .nav-link::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -4px;
    width: 100%;
    height: 1px;
    background: currentColor;
    transform: scaleX(0);
    transform-origin: left;
    transition: transform var(--transition-normal) var(--ease-default);
    opacity: 0.5;
  }

  .nav-link:hover::after {
    transform: scaleX(1);
  }

  /* Fade-in animation */
  .fade-in {
    animation: fadeIn 0.6s var(--ease-default) forwards;
    opacity: 0;
  }

  .page-enter {
    animation: pageEnter 0.45s var(--ease-default) both;
  }

  .page-enter-delay-1 {
    animation-delay: 0.08s;
  }

  .page-enter-delay-2 {
    animation-delay: 0.16s;
  }

  .page-enter-delay-3 {
    animation-delay: 0.24s;
  }

  .fade-in-delay-1 {
    animation-delay: 0.1s;
  }

  .fade-in-delay-2 {
    animation-delay: 0.2s;
  }

  .fade-in-delay-3 {
    animation-delay: 0.3s;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pageEnter {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ==========================================================================
     Prose Styles (Typography for blog content)
     ========================================================================== */

  .prose {
    @apply text-foreground text-base leading-7;

    :where(p):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 my-5;
    }

    :where(h1, h2, h3, h4, h5, h6):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground scroll-mt-24 font-medium;
    }

    :first-child:not(:where(.not-prose, .not-prose *)) {
      @apply mt-0;
    }

    :where(h1):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-6 text-4xl;
    }

    :where(h2):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-4 text-2xl;
    }

    :where(h3):not(:where(.not-prose, .not-prose *)) {
      @apply mt-8 mb-4 text-xl;
    }

    :where(h4):not(:where(.not-prose, .not-prose *)) {
      @apply mt-7 mb-3 text-lg;
    }

    :where(h5, h6):not(:where(.not-prose, .not-prose *)) {
      @apply mt-5 mb-3;
    }

    :where(a):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground decoration-muted-foreground hover:decoration-foreground font-medium wrap-break-word underline underline-offset-[3px] transition-colors;
    }

    :where(strong):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground font-medium;
    }

    :where(ul):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-5 ml-6 list-disc [&>li]:mt-2;
    }

    :where(ol):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-5 ml-6 list-decimal [&>li]:mt-2;
      @apply [[type="A"]]:list-[upper-alpha] [[type="I"]]:list-[upper-roman] [[type="a"]]:list-[lower-alpha] [[type="i"]]:list-[lower-roman];
    }

    :where(li):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 pl-2 [&>p]:my-0;
    }

    :where(ul ul, ol ol, ul ol, ol ul):not(:where(.not-prose, .not-prose *)) {
      @apply marker:text-foreground/30 my-2 ml-6;
    }

    :where(code):not(:where(.not-prose, .not-prose *)) {
      @apply bg-muted/50 text-foreground relative rounded-sm px-[0.3rem] py-[0.2rem] text-sm font-medium wrap-break-word;
    }

    :where(blockquote):not(:where(.not-prose, .not-prose *)) {
      @apply **:text-muted-foreground my-6 border-l-2 pl-6;
    }

    :where(hr):not(:where(.not-prose, .not-prose *)) {
      @apply my-8 border-t;
    }

    :where(table):not(:where(.not-prose, .not-prose *)) {
      @apply mx-auto my-6 block max-w-fit overflow-x-auto text-sm;
    }

    :where(thead):not(:where(.not-prose, .not-prose *)) {
      @apply border-muted-foreground/30 border-b;
    }

    :where(th):not(:where(.not-prose, .not-prose *)) {
      @apply px-4 py-2 font-medium;
      @apply text-left [[align="center"]]:text-center [[align="right"]]:text-right;
    }

    :where(tr):not(:where(.not-prose, .not-prose *)) {
      @apply border-muted-foreground/30 border-y first:border-t-0 last:border-b-0;
    }

    :where(td):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground/80 px-4 py-2 align-top wrap-break-word *:first:mt-0! *:last:mb-0!;
      @apply text-left [[align="center"]]:text-center [[align="right"]]:text-right;
    }

    :where(img, video, figure, .expressive-code):not(:where(.not-prose, .not-prose *)) {
      @apply mx-auto my-6;
    }

    :where(pre):not(:where(.not-prose, .not-prose *)) {
      @apply max-h-[min(68vh,1000px)]! overflow-y-auto;
    }

    :where(kbd):not(:where(.not-prose, .not-prose *)) {
      @apply text-foreground bg-muted rounded-md border px-2 py-1 text-xs font-medium;
    }
  }
}

@layer base {
  ::view-transition-old(page-main),
  ::view-transition-new(page-main) {
    animation-duration: 220ms;
    animation-timing-function: var(--ease-default);
  }

  ::view-transition-old(page-main) {
    animation-name: fadeOut;
  }

  ::view-transition-new(page-main) {
    animation-name: fadeIn;
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* ==========================================================================
   Accessibility
   ========================================================================== */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  ::before,
  ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 0.01ms !important;
  }
}
