---
import BackLink from "@/components/BackLink.astro";
import Breadcrumb from "@/components/Breadcrumb.astro";
import Header from "@/components/Header.astro";
import Link from "@/components/Link.astro";
import { SITE } from "@/consts";
import Layout from "@/layouts/Layout.astro";
import { getAllBlogTagsWithCount } from "@/lib/data-utils";
import { Tag as TagIcon } from "lucide-astro";

const tags = await getAllBlogTagsWithCount();
---

<Layout
  title={`All Tags - Blog - ${SITE.title}`}
  description="Browse all blog posts by topic. Explore tags and discover content that interests you."
>
  <Header slot="header" />
  <main class="w-full mx-auto flex grow flex-col gap-y-8 px-4 max-w-3xl pb-12">
    <!-- Breadcrumb -->
    <Breadcrumb
      items={[
        { label: "Home", href: "/", icon: "home" },
        { label: "Tags", icon: "tags" },
      ]}
    />

    <!-- Header -->
    <div class="flex flex-col gap-y-3">
      <div class="flex items-center gap-3">
        <div class="p-2 bg-muted rounded-md">
          <TagIcon size={20} class="text-muted-foreground" />
        </div>
        <div>
          <h1 class="text-3xl font-bold text-foreground">All Tags</h1>
          <p class="text-sm text-muted-foreground">Browse posts by topic</p>
        </div>
      </div>
    </div>

    <!-- Tags -->
    {
      tags.length > 0 ? (
        <div class="flex flex-wrap gap-2">
          {tags.map(({ tag, count }) => (
            <Link
              href={`/tags/${tag}`}
              class="inline-flex items-center gap-2 px-3 py-2 bg-muted hover:bg-muted/80 text-foreground rounded-md transition-colors group"
            >
              <span class="text-sm group-hover:text-primary transition-colors">{tag}</span>
              <span class="text-xs text-muted-foreground">({count})</span>
            </Link>
          ))}
        </div>
      ) : (
        <p class="text-muted-foreground text-center py-8">No tags found.</p>
      )
    }

    <!-- Back to Blog -->
    <BackLink href="/blog" label="Back to Blog" />
  </main>
</Layout>
