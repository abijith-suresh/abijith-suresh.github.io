---
import Header from "@/components/Header.astro";
import Link from "@/components/Link.astro";
import { SITE } from "@/consts";
import Layout from "@/layouts/Layout.astro";
import { getAllBlogTagsWithCount } from "@/lib/data-utils";
import { BookOpen, ChevronRight, Home, Tag as TagIcon } from "lucide-astro";

const tags = await getAllBlogTagsWithCount();
---

<Layout
  title={`All Tags - Blog - ${SITE.title}`}
  description="Browse all blog posts by topic. Explore tags and discover content that interests you."
>
  <Header slot="header" />
  <main class="w-full mx-auto flex grow flex-col gap-y-8 px-4 max-w-3xl pb-12">
    <!-- Breadcrumb -->
    <nav class="flex items-center gap-2 text-sm text-muted-foreground">
      <Link href="/" class="flex items-center gap-1.5 hover:text-foreground transition-colors">
        <Home size={14} />
        <span>Home</span>
      </Link>
      <ChevronRight size={14} />
      <Link href="/blog" class="flex items-center gap-1.5 hover:text-foreground transition-colors">
        <BookOpen size={14} />
        <span>Blog</span>
      </Link>
      <ChevronRight size={14} />
      <span class="flex items-center gap-1.5 text-foreground">
        <TagIcon size={14} />
        <span>Tags</span>
      </span>
    </nav>

    <!-- Header -->
    <div class="flex flex-col gap-y-3">
      <div class="flex items-center gap-3">
        <div class="p-2 bg-muted rounded-md">
          <TagIcon size={20} class="text-muted-foreground" />
        </div>
        <div>
          <h1 class="text-3xl font-bold text-foreground">All Tags</h1>
          <p class="text-sm text-muted-foreground">Browse posts by topic</p>
        </div>
      </div>
    </div>

    <!-- Tags Grid -->
    {
      tags.length > 0 ? (
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
          {tags.map(({ tag, count }) => (
            <Link
              href={`/tags/${tag}`}
              class="flex items-center justify-between px-3 py-2 bg-muted hover:bg-muted/80 text-foreground rounded-md transition-colors group"
            >
              <span class="text-sm truncate group-hover:text-primary transition-colors">{tag}</span>
              <span class="text-xs text-muted-foreground ml-2 flex-shrink-0">({count})</span>
            </Link>
          ))}
        </div>
      ) : (
        <p class="text-muted-foreground text-center py-8">No tags found.</p>
      )
    }

    <!-- Back to Blog -->
    <div class="pt-6 border-t border-border">
      <Link
        href="/blog"
        class="inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors"
      >
        <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10 12L6 8L10 4"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
        Back to Blog
      </Link>
    </div>
  </main>
</Layout>
