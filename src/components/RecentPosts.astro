---
import BlogCard from "@/components/BlogCard.astro";
import Link from "@/components/Link.astro";
import { getAllBlogPosts } from "@/lib/blog";
import { cn } from "@/lib/utils";
import { Icon } from "astro-icon/components";

interface Props {
  limit?: number;
  class?: string;
}

const { limit = 3, class: className } = Astro.props;
const allPosts = await getAllBlogPosts();
const recentPosts = allPosts.slice(0, limit);
---

{
  recentPosts.length > 0 && (
    <section class:list={cn("flex flex-col gap-y-4", className)}>
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-foreground">Latest Posts</h2>
        <Link
          href="/blog"
          class="group inline-flex items-center gap-1.5 text-sm text-muted-foreground hover:text-foreground transition-colors"
          prefetch="viewport"
        >
          View all
          <Icon
            name="fa6-solid:arrow-right"
            class="w-3.5 h-3.5 transition-transform group-hover:translate-x-0.5"
          />
        </Link>
      </div>

      <div class="flex flex-col gap-4">
        {recentPosts.map((post) => (
          <BlogCard post={post} />
        ))}
      </div>
    </section>
  )
}
